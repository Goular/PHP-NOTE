# PHP开发APP接口

### APP(通信)接口定义
<pre>
	接口地址:	http://api.com/admin/id/23
	接口文件:	业务逻辑编辑 
	接口数据:	
</pre> 

### APP如何进行通讯
<pre>
					发送http请求
				-->---->----->------>
	
	客户端(C)   ---------------------    服务器(S)
					
					响应http body
				--<----<-----<------<
</pre>

###　通信数据格式区别
<pre>
	JSON
	XML	
</pre>

### 封住通讯接口数据方法
<pre>
	PHP生成JSON数据
		json_encode($value)  [该方法只能接受UTF-8编码的数据]
	
	PHP生成XML数据
		1.组装字符串
		2.使用系统类
			DomDocument
			XMLWriter
			SimpleXMLElement
</pre>

### PHP编码类型转换
<pre>
	iconv('UTF-8','GBK',$data);
</pre>

### 通信数据标准格式
<pre>
	code		状态码(200,400,等)
	message		提示信息(邮箱格式不正确，数据返回成功等)
	data 		返回的数据
</pre>

### 核心技术
<pre>
	Memcache,Redis
	学习目标
	1.掌握如何设置缓存操作
	2.掌握如何获取缓存操作
	3.掌握如何删除缓存操作
</pre>


### APP接口实例
<pre>
	1.单例模式链接数据库
	2.首页接口开发以及客户端APP演示
	3.APP版本升级以及APP演示
	4.APP错误日志接口
</pre>

### 单例模式链接数据库
<pre>
	PHP是页面级别的脚本语言，单例模式仅适合于作为同一请求多个数据库连接操作
	Java若使用单例模式来处理数据库连接，容易造成并发事务死锁问题
	懒汉式 饿汉式
</pre>

###　方案一:读取数据库方式开发首页接口
<pre>
	应用场景：数据时效性比较高的系统
	从数据库获取信息--封装--生成接口数据
</pre>

### 方案二:读取缓存方式开发首页接口
<pre>
	用途:减少数据库压力 例如:搜狐和优酷
	请求--缓存--[没有缓存数据]从数据库获取信息--封装---返回数据
	再次请求--缓存[有缓存数据]--封装---返回数据
</pre>

###APP接口实例
<pre>
	首页接口方案一:
		流程
	HTTP请求--服务器--查询数据--返回数据

	//下面这种写法比较好，因为我们可以使用return说明后面没有语句了，即使我们的show方法已经包含了exit的内容，因为接手的人确实不知道我们的方法内部含有exit的语言结构方法.
	if($data) {
		return Response::show(200, '首页数据获取成功', $data);
	}else{
		return Response::show(400, '首页数据获取失败', $data);
	}
	
	定时读取缓存方式开发首页接口
		开启APP-->请求初始化接口init.php-->检测是否更新-->是-->更新-->App首页
		开启APP-->请求初始化接口init.php-->检测是否更新-->否-->首页
</pre>

###　设计App更新的接口
<pre>
	更新的数据库表的设计按jpg来处理
</pre>


